#!/usr/bin/env nix-shell
#!nix-shell -i bash -p libsecret -p systemd
# deletes Fractal accounts, which are prone to breakages

systemctl --user stop fractal

# first, ensure the relevant secrets are unlocked
secret-tool search --all --unlock 'xdg:schema' 'org.gnome.Fractal'
secret-tool search --all --unlock 'xdg:schema' 'org.gnome.Fractal.Hack'

# then, delete them
secret-tool clear 'xdg:schema' 'org.gnome.Fractal'
secret-tool clear 'xdg:schema' 'org.gnome.Fractal.Hack'

# N.B.: it may be necessary still to delete ~/.local/share/fractal/* (unsure)
